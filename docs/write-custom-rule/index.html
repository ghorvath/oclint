
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Write Custom Rule - OCLint, a static source code analysis tool for Objective-C and related languages</title>
  <meta name="author" content="Longyi Qi">

  
  <meta name="description" content="        Write Custom Rule          To write your own rule, you need a certain level of knowledge about Clang, especially understand well in Abstrac...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://oclint.org/docs/write-custom-rule/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="OCLint" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">OCLint</a></h1>
  
    <h2>A static source code analysis tool for Objective-C and related languages</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:oclint.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog">Blog</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="/rules">Rules</a></li>
  <li><a href="/coverage/index.html">Code Coverage</a></li>
  <li><a href="/selfinspection.txt">Self Inspection</a></li>
  <li><a href="/license">License</a></li>
  <li><a href="https://github.com/longyiqi/oclint">Source</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">Write Custom Rule</h1>
    
  </header>
  
  <p>To write your own rule, you need a certain level of knowledge about Clang, especially understand well in <a href="http://en.wikipedia.org/wiki/Abstract_syntax_tree">Abstract Syntax Tree</a> representation of Clang compiler. (Of course, you can just read particular node type for your need, and Clang code is very easy to read and understand.)</p>

<p>And modifying rules currently included with OCLint source code is a good place to start. Check out <a href="https://github.com/longyiqi/mo/tree/master/src/headers/mo/rule">headers</a> and <a href="https://github.com/longyiqi/mo/tree/master/src/impl/mo/rule">implementations</a>.</p>

<h2>Write Rule</h2>

<p>In front of all, you need to have a working copy of OCLint, you can read this document about <a href="/docs/compile">how to compile OCLint</a></p>

<p>As SampleRule shown below, your rule must be a sub-class of Rule. And write your own logic in the apply() function, and give rule name in name() function. Please notice that, to make this rule can be dynamically loaded into the main program, please initialize it in the static constructor.</p>

<figure class='code'><figcaption><span>SampleRule.cpp </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cp">#include &quot;mo/Rule.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;mo/RuleSet.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;mo/ViolationSet.h&quot;</span>
</span><span class='line'><span class="cp">#include &quot;mo/Violation.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">SampleRule</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Rule</span> <span class="p">{</span>
</span><span class='line'><span class="k">private</span><span class="o">:</span>
</span><span class='line'>  <span class="k">static</span> <span class="n">RuleSet</span> <span class="n">rules</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">public</span><span class="o">:</span>
</span><span class='line'>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">apply</span><span class="p">(</span><span class="n">CXCursor</span><span class="o">&amp;</span> <span class="n">node</span><span class="p">,</span> <span class="n">CXCursor</span><span class="o">&amp;</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">ViolationSet</span><span class="o">&amp;</span> <span class="n">violationSet</span><span class="p">);</span>
</span><span class='line'>  <span class="k">virtual</span> <span class="k">const</span> <span class="n">string</span> <span class="n">name</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'>
</span><span class='line'><span class="n">RuleSet</span> <span class="n">SampleRule</span><span class="o">::</span><span class="n">rules</span><span class="p">(</span><span class="k">new</span> <span class="n">SampleRule</span><span class="p">());</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="n">SampleRule</span><span class="o">::</span><span class="n">apply</span><span class="p">(</span><span class="n">CXCursor</span><span class="o">&amp;</span> <span class="n">node</span><span class="p">,</span> <span class="n">CXCursor</span><span class="o">&amp;</span> <span class="n">parentNode</span><span class="p">,</span> <span class="n">ViolationSet</span><span class="o">&amp;</span> <span class="n">violationSet</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// fill in your logic here</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">const</span> <span class="n">string</span> <span class="n">SampleRule</span><span class="o">::</span><span class="n">name</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="s">&quot;sample rule&quot;</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>And you are highly recommended to write tests for your rules.</p>

<h2>Compile Rule</h2>

<p>Copy your rule to the same folder, parallel with other rules. Add its class name to SET(LIST_OF_RULES RuleName) section in <a href="https://github.com/longyiqi/oclint/blob/master/src/impl/oclint/rule/CMakeLists.txt">CMakeLists</a> file.</p>

<p>Re-compile OCLint, and your rule will be built together with other rules.</p>

<h2>Use Rule</h2>

<p>Same as other rules, you can take the advantages of <a href="/docs/rules"><em>plug-and-use</em></a>, and use your rules wisely based on your project.</p>

<p><a href="/docs/how-it-works">How it works</a> will briefly show you the architecture of OCLint</p>

  
    <footer>
      
      
    </footer>
  
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
  </ul>
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/us/">Creative Commons Attribution-Noncommercial-Share Alike 3.0 United States License</a> - Maintained by <a href="http://www.longyiqi.com" target="_BLANK">Longyi Qi</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
